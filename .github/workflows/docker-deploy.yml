name: Deploy Infrastructure

on:
  workflow_run: 
    workflows: ["Docker Build"]
    types: 
      - completed

jobs:

  deploy:

    runs-on: ubuntu-latest
    
    steps:
    
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Setup Terraform  
      uses: hashicorp/setup-terraform@v1

    - name: Terraform Apply
      run: |
        terraform fmt
        terraform init
        terraform validate
        terraform plan
        terraform apply -auto-approve
